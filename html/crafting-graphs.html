<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Graphics from graphs</title>
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <style type="text/css">

      body {
      font-family: Helvetica, Arial, clean, sans-serif;
      font-size: 14.5px;
      line-height: 1.5;
      margin: 0;
      padding: 0;
      color: #111;
      background-color:#fdfdfd;
      }

      a {
      text-decoration: none;
      }

      .comic {
      display: inline-block;
      margin-right: 30px;
      }

      .comic:last-child {
      margin-right: 0;
      }

      .caption {
      display:inline-block;
      max-width:165px;
      vertical-align: top;
      }

      .quoted {
      border: 1px solid black;
      padding:10px;
      }

      p {
      max-width: 600px;
      }

      .site-header {
      border-top: 5px solid #424242;
      border-bottom: 1px solid #e8e8e8;
      min-height: 56px;
      position: relative;
      }

      .site-title {
      font-size: 18px;
      line-height: 56px;
      letter-spacing: -1px;
      margin-bottom: 0;
      float: left;
      }

      .site-title, .site-title:visited {
      color: #a00;
      }

      .wrapper {
      max-width: 800px;
      padding-left: 30px;
      }

      .wrapper:after, .footer-col-wrapper:after {
      content: "";
      display: table;
      clear: both;
      }

      .harmonicGratingImage {
      width: 300px;
      }

      .meta {
      font-size: 11px;
      color: #828282;
      text-transform: uppercase;
      margin-top: -14px;
      }

    </style>
  </head>
  <body>
    <header class="site-header">
      <div class="wrapper">
	<a class="site-title" href="/">Marcus Lewis</a>
      </div>
    </header>
    <div class="wrapper">
      <div>
	<h1>Graphics from graphs</h1>
	<p class="meta">April 2015</p>
	<p>In my studies, I encountered some images, and I wanted to explore them. I wanted to check the colors of pixels, to tweak parameters and see what happened. The textbook didn't offer that feature, so I took matters into my own hands.</p>
	<p>I reverse-engineered the images into an inspectable, tweakable form. I paced back and forth for a while and discovered the UI that each image deserved, then built it.</p>
	<p>As I created multiple images and untangled what they had in common, it became clearer and clearer what I was actually doing: creating 3D graphs and using <em>color</em> as the third dimension.</p>
	<p>This got me thinking: is it really this difficult to create images by creating graphs? What general-purpose tool could have created these images? The problem with the explorable images on this page is that they took too long to create. Students and scientists need to spend their time thinking about their domain, not about optimizing an HTML canvas's inner loop.</p>
	<p>I haven't found the answer. I don't have a general-purpose tool to show you. But I'll show you the explorable images, and I'll show some very early sketches of the tool that I wish existed.</p>
	<h2>Background: Gratings in visual perception</h2>
	<p>Optical illusions are an important part of the science of visual perception. Each illusion is a hint into how the brain works. It's a bit of evidence that we can use to figure out what's going on behind the scene.</p>
	<p><em>Spatial frequency</em> has taken hold as a <a href="http://en.wikipedia.org/wiki/Language_primitive">primitive</a> in vision theory. Here, play with this:</p>
	<div id="simple-grating"></div>
	<p>That's spatial frequency.</p>
	<p>When you move your eyes, you rotate them a certain number of degrees. In vision science, spatial frequency is measured in cycles per degree of the visual field.</p>
	<p>Part of the reason spatial frequency gets a lot of <a href="https://scholar.google.com/scholar?q=spatial+frequency">air time</a> is because we've shown its profound relevance via optical illusions.</p>
	<p>Copied below: Some illustrations and descriptions from the original 1974 Scientific American paper and from a recent textbook.</p>
	<h3>Grating with harmonics</h3>
	<p>Here's a set of images and descriptions from a Scientific American paper. I split the images and descriptions into a more <a href="http://worrydream.com/ScientificCommunicationAsSequentialArt/">comic-book</a> form.</p>
	<div class="quoted" style="width:975px;">
	  <p>GRATING PATTERNS shown here are photographs of patterns produced on the screen of a cathode ray tube by a voltage-modulating generator.</p>
	  <div>
	    <div class="comic">
	      <img src="images/ScientificAmericanHarmonicGratingA.png" class="harmonicGratingImage" />
	      <p class="caption">A simple grating is produced by a single sine wave signal from the voltage generator. The brightness of each vertical bar in this simple grating varies in a sinusoidal manner in the horizontal direction across the pattern.</p>
	    </div>
	    <div class="comic">
	      <p class="caption">A more complex grating is formed by the addition of the <strong>third harmonic</strong> of the fundamental sine wave. The third harmonic has three times the frequency and a third of the amplitude of the fundamental wave.</p>
	      <img src="images/ScientificAmericanHarmonicGratingB.png" class="harmonicGratingImage" />
	    </div>
	  </div>
	  <p>As the frequency of the light and dark bands increases with the addition of...</p>
	  <div>
	    <div class="comic">
	      <p><strong>the fifth harmonic,</strong></p>
	      <img src="images/ScientificAmericanHarmonicGratingC.png" class="harmonicGratingImage" />
	    </div>
	    <div class="comic">
	      <p><strong>the seventh,</strong></p>
	      <img src="images/ScientificAmericanHarmonicGratingD.png" class="harmonicGratingImage" />
	    </div>
	    <div class="comic">
	      <p><strong>and the ninth,</strong></p>
	      <img src="images/ScientificAmericanHarmonicGratingE.png" class="harmonicGratingImage" />
	    </div>
	  </div>
	  <p>the individual bands formed by the harmonics become progressively more difficult to see.</p>
	  <div>
	    <p class="caption" style="max-width: 330px;">With the addition of <strong>the 15th harmonic</strong> only a square-wave pattern is perceived. </p>
	    <img src="images/ScientificAmericanHarmonicGratingF.png" class="harmonicGratingImage" />
	  </div>
	  <p style="max-width: 800px;">Studies of contrast perception with simple and complex grating patterns such as these indicate that the visual system possesses a number of separate "channels," each spatial tuned to detect a relatively narrow range of spatial frequencies and each with its own range of sensitivity to contrast.</p>
	  <p>Source: Campwell, F.W. and Maffei, L. (1974). Contrast and spatial frequency. <em>Scientific American</em> 231, 106-13</p>
	</div>
	<h3>Sweep grating</h3>
	<p>Here's another image from the 1974 Scientific American paper:</p>
	<div class="quoted">
	  <img src="images/ScientificAmericanSweepGrating.png" width="490" />
	  <p class="caption">SINUSOIDAL GRATING with a logarithmic variation in spatial frequency and in contrast demonstrates the loss of contrast sensitivity at low and high spatial frequencies. The contrast decreases from the bottom to the top, but at any one height it is the same for all spatial frequencies. When the grating is viewed, it is apparent that the intermediate spatial frequencies are visible to much lower contrast than either the low or the high spatial frequencies.</p>
	  <p>Source: Campwell, F.W. and Maffei, L. (1974). Contrast and spatial frequency. <em>Scientific American</em> 231, 106-13</p>
	</div>
	<p>This image was printed to a magazine in 1974 and then scanned back into a computer, so it's hard to say how similar it is to the original. A cleaner version can be seen in recent textbooks:</p>
	<div class="quoted">
	  <img src="images/BasicVisionSpatialFrequency.png" width="310" style="margin-top:25px; margin-right: 10px;" />
	  <img src="images/BasicVisionSensitivity.png" width="327" style="vertical-align:top;" />
	  <p>Contrast sensitivity at various spatial frequencies. The spatial frequency of this grating increases from low at the left to high at the right, and the contrast increases from top to bottom. Clearly, we are most sensitive to some middle spatial frequency, with lower sensitivity to both high and low spatial frequencies.</p>
	  <p>Source: <a href="http://www.amazon.com/Basic-Vision-Introduction-Visual-Perception/dp/019957202X">Basic Vision</a>, Snowden, Thompson, Troscianko, Oxford University Press 2012</p>
	</div>
	<p>But to really convince yourself of this effect, you need to be able to inspect the image. You can't just take the author's word for it. They tell you that what you see is an illusion, but is it really? Is spatial frequency really the thing responsible for these effects?</p>
      </div>
      <h2>Explorable images</h2>
      <p>This is where I step in.</p>
      <p>These "explorable images" are a special case of <a href="http://worrydream.com/ExplorableExplanations/">explorable explanations</a>. This ought to become the new normal for publications.</p>
      <h3>Grating with harmonics</h3>
      <div id="3-harmonic-grating" style="width:1000px;"></div>
      <h3>Sweep grating</h3>
      <div id="2-sweep-grating" style="width:1000px;"></div>
      <h3>Drag and inspect</h3>
      <p>Drag an image from your computer to inspect its color and rows.</p>
      <div id="4-drag-and-inspect"></div>
      <h2>Breaking down the knobs</h2>
      <p>Here are some design notes. I like clear thinking, and I think I have some to share.</p>
      <p>Let's call this an "explorable fixed algorithm".</p>
      <div id="plain-algorithm"></div>
      <p>I stole this from <a href="http://worrydream.com/LadderOfAbstraction/">Bret Victor</a>. I even used his slider PNGs. Thanks, Bret!</p>
      <p>These can be wonderfully tweakable. But they're also fixed -- you can't add and remove steps from the algorithm. The author has to anticipate all the fruitful knobs and levers. Solving this limitation is mostly out of scope for this essay.</p>
      <p>Within these algorithms we <strong>choose numbers</strong>, we <strong>transform numbers</strong>, and we <strong>translate numbers into colors</strong>. In the harmonic grating, I packed "choose numbers" and "transform numbers" into one step, whereas in the sweep grating, I lumped "transform numbers" in with "translate into colors".</p>
      <h3>Choosing numbers</h3>
      <p>In the <strong>sweep grating</strong>, we choose a number for each column of pixels.</p>
      <div id="sweep-grating-number-chooser"></div>
      <p>The explorable algorithm lets you choose the type of wave, and it lets you vary the wave's period over space. The wave is shown in the background so that you can see what you're doing.</p>
      <p>On the varying period, I give myself an A. It's easy to comprehend, and it's very flexible. You choose two endpoints, and you adjust a Cubic Bézier curve to choose the interpolation between these endpoints (i.e. the <a href="http://mrcslws.com/blocks/2015/02/26/using-bezier-curves-as-easing-functions.html">easing function</a>). Here's why this is so good: it breaks free of math. You're no longer bound by the world of equations. You're <a href="http://en.wikipedia.org/wiki/Variety_(cybernetics)#The_law_of_requisite_variety">manipulating a visual thing by using a visual thing.</a></p>
      <p>On the wave picker, I give myself a C, for predictable reasons. There's an infinite number of ways to oscillate between -1 and 1, and I provided... 4 options? A better design would offer a "cycle this Bézier curve" option.</p>
      <h3>Choosing + transforming numbers</h3>
      <p>In the <strong>grating with harmonics</strong>, we choose a number for each column of pixels, then choose another and compute the sum, and so on. It's an imperative loop.</p>
      <div id="harmonic-grating-number-chooser"></div>
      <p>These numbers are mostly visualized. Each wave is in the background, and the resulting wave is in the foreground.</p>
      <p>My favorite part is the editable number list. Play with it! The visualization updates as you type. See what happens with "1 2 3 4 5".</p>
      <p>There are some obvious missing features. The "1/n" should be tweakable. Similar to above, "choose one of these 4 waves" is limiting. And if we want to get really crazy: what if I want to combine different types of wave?</p>
      <h3>Translating numbers into color</h3>
      <p>In the <strong>grating with harmonics</strong>, we simply translate each number into color using a tweakable legend.</p>
      <div id="harmonic-grating-color-chooser"></div>
      <p>The color knobs are adjustable. You can move them, and you can change their color. You create a linear gradient, and the legend extrapolates this gradient past the knobs.</p>
      <p>The color knobs use your browser's built-in color picker, or fall back to a live-updating text input.</p>
      <p>One critique: this legend doesn't warn you when you create invalid colors. When it extrapolates past the knob, it will happily choose an RGB value outside of the [0, 255] range. Browsers will quietly convert this number to the appropriate boundary.</p>
      <h3>Transforming numbers + translating into color</h3>
      <p>In the <strong>sweep grating</strong>, we use the previously-selected per-column number, we damp it toward 0 according to its pixel row, and we translate it into color.</p>
      <p>Another way to think of this: we apply a varying legend to the numbers that we chose. The legend varies by row.</p>
      <div id="sweep-grating-color-chooser"></div>
      <p>To help you see what you're doing, I show little thingies that I call "feature trackers". </p>
      <p>[I'm still writing!]</p>
    </div>
    <script src="crafting_graphs.js" type="text/javascript"></script>
  </body>
</html>
